launch-templates:
  custom-linux-medium-plus-js:
    resourceClass: 'docker_linux_amd64/medium+'
    image: 'ubuntu22.04-node20.11-v7'
    init-steps:
      - name: checkout repo
        uses: 'nrwl/nx-cloud-workflows/v4/workflow-steps/checkout/main.yaml'
        env:
          GIT_FETCH_TAGS: 'true'
      - name: node_modules cache
        uses: 'nrwl/nx-cloud-workflows/v4/workflow-steps/cache/main.yaml'
        inputs:
          key: 'yarn.lock'
          paths: 'node_modules'
          baseBranch: 'main'
      - name: NPM Install
        uses: 'nrwl/nx-cloud-workflows/v4/workflow-steps/install-node-modules/main.yaml'
        env:
          SKIP_POSTINSTALL: 'true'
      - name: Apply patches
        script: 'yarn patch-package --patch-dir ./tools/patches'
      - name: Clear Jest Cache
        script: 'npx jest --clearCache'
